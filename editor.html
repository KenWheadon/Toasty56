<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Story Config Editor</title>
    <!-- CSS Components -->
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/panels.css" />
    <link rel="stylesheet" href="css/forms.css" />
    <link rel="stylesheet" href="css/preview.css" />
    <link rel="stylesheet" href="css/scenes.css" />
    <link rel="stylesheet" href="css/assets.css" />
    <link rel="stylesheet" href="css/modal.css" />
    <link rel="stylesheet" href="css/node-editor.css" />
  </head>
  <body>
    <div id="editor-container">
      <!-- Selected Object Panel -->
      <div class="selected-object-panel" id="selected-object-panel">
        <div id="object-properties" class="object-properties"></div>
      </div>

      <!-- Main Editor Area -->
      <div class="editor-main">
        <!-- Left Panel: Scene Properties + Assets -->
        <div class="left-panel">
          <!-- Scene Properties -->
          <!-- Assets -->
          <div class="panel-section asset-panels">
            <div class="asset-section">
              <div class="asset-drop-zone" id="background-drop-zone">
                <div class="drop-zone-visual">
                  <div class="drop-zone-icon">
                    Backgrounds: Click of drag here
                  </div>
                </div>
                <div id="background-list" class="asset-list"></div>
              </div>
            </div>
            <div class="asset-section">
              <div class="asset-drop-zone" id="object-drop-zone">
                <div class="drop-zone-visual">
                  <div class="drop-zone-icon">Objects: Click of drag here</div>
                </div>
                <div id="object-list" class="asset-list"></div>
              </div>
            </div>
            <p class="drag-instructions">
              Adding objects: Drag them directly from the library to the scene
            </p>
          </div>
        </div>

        <!-- Effect Controls Drawer -->
        <div id="effect-controls-drawer" class="effect-controls-drawer">
          <div class="drawer-header">
            <h4>Effect Settings</h4>
            <button class="drawer-close" id="close-effect-drawer">
              &times;
            </button>
          </div>
          <div class="drawer-content" id="effect-drawer-content">
            <!-- Effect controls will be populated here -->
          </div>
        </div>

        <!-- UI Positioning Drawer -->
        <div id="ui-positioning-drawer" class="ui-positioning-drawer">
          <div class="drawer-header">
            <h4>UI Positioning</h4>
            <button class="drawer-close" id="close-ui-positioning-drawer">
              &times;
            </button>
          </div>
          <div class="drawer-content" id="ui-positioning-drawer-content">
            <!-- Default UI Position Controls -->
            <div class="drawer-section">
              <div class="default-position-controls">
                <div class="default-position-group">
                  <h4>Text Content Defaults</h4>
                  <div class="slider-group">
                    <label>X Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-text-pos-x"
                        min="0"
                        max="100"
                        step="0.1"
                        value="50"
                      />
                      <span class="slider-value" id="default-text-pos-x-value"
                        >50.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Y Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-text-pos-y"
                        min="0"
                        max="100"
                        step="0.1"
                        value="85"
                      />
                      <span class="slider-value" id="default-text-pos-y-value"
                        >85.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Width:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-text-width"
                        min="10"
                        max="100"
                        step="1"
                        value="80"
                      />
                      <span class="slider-value" id="default-text-width-value"
                        >80%</span
                      >
                    </div>
                  </div>
                </div>

                <div class="default-position-group">
                  <h4>Button Container Defaults</h4>
                  <div class="slider-group">
                    <label>X Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-buttons-pos-x"
                        min="0"
                        max="100"
                        step="0.1"
                        value="80"
                      />
                      <span
                        class="slider-value"
                        id="default-buttons-pos-x-value"
                        >80.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Y Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-buttons-pos-y"
                        min="0"
                        max="100"
                        step="0.1"
                        value="85"
                      />
                      <span
                        class="slider-value"
                        id="default-buttons-pos-y-value"
                        >85.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Width:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-buttons-width"
                        min="10"
                        max="100"
                        step="1"
                        value="40"
                      />
                      <span
                        class="slider-value"
                        id="default-buttons-width-value"
                        >40%</span
                      >
                    </div>
                  </div>
                </div>

                <div class="default-position-group">
                  <h4>Choice Button Defaults</h4>
                  <div class="slider-group">
                    <label>X Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-choice-pos-x"
                        min="0"
                        max="100"
                        step="0.1"
                        value="80"
                      />
                      <span class="slider-value" id="default-choice-pos-x-value"
                        >80.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Y Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-choice-pos-y"
                        min="0"
                        max="100"
                        step="0.1"
                        value="85"
                      />
                      <span class="slider-value" id="default-choice-pos-y-value"
                        >85.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Width:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="default-choice-width"
                        min="10"
                        max="100"
                        step="1"
                        value="40"
                      />
                      <span class="slider-value" id="default-choice-width-value"
                        >40%</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Current Scene UI Position Controls -->
            <div class="drawer-section">
              <div class="ui-position-controls">
                <div class="ui-position-group">
                  <div class="position-group-header">
                    <h4>Text Position</h4>
                    <button
                      class="btn btn-small btn-reset"
                      id="reset-text-position"
                    >
                      Reset
                    </button>
                  </div>
                  <div class="slider-group">
                    <label>X Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="text-pos-x"
                        min="0"
                        max="100"
                        step="0.1"
                        value="50"
                      />
                      <span class="slider-value" id="text-pos-x-value"
                        >50.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Y Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="text-pos-y"
                        min="0"
                        max="100"
                        step="0.1"
                        value="85"
                      />
                      <span class="slider-value" id="text-pos-y-value"
                        >85.0%</span
                      >
                    </div>
                  </div>
                </div>
                <div class="ui-position-group">
                  <div class="position-group-header">
                    <h4>Buttons Position</h4>
                    <button
                      class="btn btn-small btn-reset"
                      id="reset-buttons-position"
                    >
                      Reset
                    </button>
                  </div>
                  <div class="slider-group">
                    <label>X Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="buttons-pos-x"
                        min="0"
                        max="100"
                        step="0.1"
                        value="80"
                      />
                      <span class="slider-value" id="buttons-pos-x-value"
                        >80.0%</span
                      >
                    </div>
                  </div>
                  <div class="slider-group">
                    <label>Y Position:</label>
                    <div class="slider-container">
                      <input
                        type="range"
                        id="buttons-pos-y"
                        min="0"
                        max="100"
                        step="0.1"
                        value="85"
                      />
                      <span class="slider-value" id="buttons-pos-y-value"
                        >85.0%</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Choice Positions -->
            <div
              class="drawer-section"
              id="choice-positions-section-drawer"
              style="display: none"
            >
              <div
                id="choice-positions-list"
                class="choice-positions-list"
              ></div>
            </div>
          </div>
        </div>

        <!-- Center Panel: Scene Preview -->
        <div class="center-panel">
          <div class="scene-preview" id="scene-preview">
            <div class="preview-scene" id="preview-scene">
              <div class="drop-zone">Drop objects here or click to place</div>
            </div>
          </div>
        </div>

        <!-- Right Panel: Content & Choices -->
        <div class="right-panel">
          <div class="header-controls">
            <button id="new-scenario" class="btn btn-primary">
              New Scenario
            </button>
            <button id="load-project" class="btn btn-secondary">
              Load Project
            </button>
            <button id="save-project" class="btn btn-success">
              Save Project
            </button>
            <div class="auto-save-status" id="auto-save-status">
              Auto-save: <span id="auto-save-indicator">Ready</span>
            </div>
            <input
              type="file"
              id="file-input"
              accept=".json"
              style="display: none"
            />
            <input
              type="file"
              id="asset-file-input"
              accept="image/*"
              multiple
              style="display: none"
            />
          </div>

          <div class="panel-section info-panel">
            <div class="form-group">
              <label>Scene:</label>
              <div class="scene-id-name-group">
                <span id="scene-id-display" class="scene-id-display">1:</span>
                <input
                  type="text"
                  id="scene-name"
                  placeholder="Scene Name"
                  class="scene-name-input"
                />
              </div>
            </div>
            <div class="form-group">
              <label>Type:</label>
              <select id="scene-type">
                <option value="choice">Choice</option>
                <option value="image">Image</option>
              </select>
            </div>
            <div class="form-group">
              <label>Background:</label>
              <select id="scene-background">
                <option value="">No Background</option>
              </select>
            </div>
            <div class="form-group" id="next-scene-group">
              <label>Next Scene:</label>
              <select id="next-scene">
                <option value="">Select Scene</option>
                <option value="null">End</option>
              </select>
            </div>
          </div>

          <!-- UI Positioning Button -->
          <div class="panel-section">
            <button
              id="open-ui-positioning"
              class="btn btn-primary btn-full-width"
            >
              <span class="btn-icon">⚙️</span>
              UI Positioning
            </button>
          </div>

          <!-- Overlay Properties -->
          <div class="panel-section">
            <div id="overlay-controls" class="overlay-controls">
              <div class="form-group">
                <label>
                  <input type="checkbox" id="overlay-enabled" /> Enable Overlay
                </label>
              </div>
              <div class="form-group">
                <input type="color" id="overlay-color" value="#000000" />
              </div>
              <div class="slider-group">
                <label>Opacity:</label>
                <div class="slider-container">
                  <input
                    type="range"
                    id="overlay-opacity"
                    min="0"
                    max="1"
                    step="0.1"
                    value="0.5"
                  />
                  <span class="slider-value" id="overlay-opacity-value"
                    >0.5</span
                  >
                </div>
              </div>
              <div class="slider-group">
                <label>Z-Index:</label>
                <div class="slider-container">
                  <input
                    type="range"
                    id="overlay-zindex"
                    min="1"
                    max="100"
                    step="1"
                    value="45"
                  />
                  <span class="slider-value" id="overlay-zindex-value">45</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Scene Content -->
          <div class="panel-section">
            <h3>Scene Content</h3>
            <div class="form-group">
              <label>Content:</label>
              <textarea
                id="scene-content"
                placeholder="Scene content/text"
              ></textarea>
            </div>

            <!-- Scene Objects List -->
            <div class="scene-objects-section">
              <h4>Objects in Scene</h4>
              <div id="scene-objects-list" class="scene-objects-list"></div>
            </div>
          </div>

          <!-- Choices -->
          <div class="panel-section" id="choices-section">
            <button id="add-choice" class="btn btn-small">Add Choice</button>
            <div id="choices-list" class="choices-list"></div>
          </div>
        </div>
      </div>

      <!-- Bottom Panel: Scenes -->
      <div class="bottom-panel">
        <div class="scene-controls">
          <button id="add-scene" class="btn btn-small">Add Scene</button>
          <button id="duplicate-scene" class="btn btn-small">Duplicate</button>
          <button id="delete-scene" class="btn btn-small btn-danger">
            Delete
          </button>
          <button
            id="open-node-editor"
            class="btn btn-small node-editor-button"
          >
            <span class="node-editor-icon">🕸️</span>
            Node Editor
          </button>
        </div>
        <div id="scene-list" class="scene-list-horizontal"></div>
      </div>
    </div>

    <!-- Modal for warnings -->
    <div id="warning-modal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Warning</h3>
        <p id="warning-message"></p>
      </div>
    </div>

    <!-- Modal for new scenario confirmation -->
    <div id="new-scenario-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="new-scenario-close">&times;</span>
        <h3>New Scenario</h3>
        <p id="new-scenario-message">
          Are you sure you want to create a new scenario? This will clear all
          current work and cannot be undone.
        </p>
        <div class="modal-buttons">
          <button id="confirm-new-scenario" class="btn btn-danger">
            Yes, Create New Scenario
          </button>
          <button id="cancel-new-scenario" class="btn btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- JavaScript Components -->
    <script src="js/utils.js"></script>
    <script src="js/project-manager.js"></script>
    <script src="js/asset-manager.js"></script>
    <script src="js/scene-manager.js"></script>
    <script src="js/preview-manager.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/node-editor.js"></script>
    <script src="js/editor.js"></script>
  </body>
</html>
